/*!
 * JavaScript Class Library v0.5.1 (JSC v0.5.1)
 *
 * Copyright 2012 Jean-Sebastien CONAN
 * Released under the MIT license
 */
(function(e,t){var n=this,r=0,i="Class",s="Unexpected error !",o="%s : This method is abstract and has to be overloaded !",u="Class [%s] not found !",a="This class cannot be directly instantiated !",f="className",l="pluginName",c="guid",h="_abstract",p="_attached",d="_overload",v="_plugin",m={},g=[],y={},b="",w=g.slice,E=y.hasOwnProperty,S=y.toString,x=/^\[object\s(.*)\]$/,T=/xyz/.test(function(){xyz()})?/\binherited\b/:/.*/,N=/\s*([\(\)\[\]\{\};]+)\s*/g,C=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,k=/^([*]?[\s+>~]*[#.\w-\[:*]+[#.\w-\[\]=\(\)"'*~^$:]*)+$/,L=/^(((https?|ftps?):\/\/)((\w+:?\w*@)?(\S+)(:[0-9]+)?)?)?([\w-.\/]+[.\/])+([\w#!:.,;?+=&%@!\-\/])+$/,A=/([a-z0-9]+)_([a-z0-9])/gi,O=/([a-z0-9]+)([A-Z])/g,M=/([^\w\s])/g,_=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,D=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,P=/^[\],:{}\s]*$/,H=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,B=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,j=/(?:^|:|,)(?:\s*\[)+/g,F="object ",I="["+F+"Array]",q="["+F+"Object]",R="["+F+"Function]",U="["+F+"String]",z="["+F+"Boolean]",W=function(e){return e},X=function(e){var t=e.getUTCMonth()+1,n=e.getUTCDate(),r=e.getUTCHours(),i=e.getUTCMinutes(),s=e.getUTCSeconds(),o=e.getUTCMilliseconds();return e.getUTCFullYear()+"-"+(t<10?"0"+t:t)+"-"+(n<10?"0"+n:n)+"T"+(r<10?"0"+r:r)+":"+(i<10?"0"+i:i)+":"+(s<10?"0"+s:s)+"."+(o<10?"00"+o:o<100?"0"+o:o)+"Z"},V=function(e){var t,n={};for(t in e){n["["+F+t+"]"]=e[t]}return n},$=function(e){var t,n={};for(t=0;t<e.length;t++){n["["+F+e[t]+"]"]=e[t]}return n}(["Array","Boolean","Date","Function","Object","Number","RegExp","String"]),J={'"':'\\"',"\\":"\\\\","	":"\\t","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r"},K=V({String:function(e){return _.test(e)?'"'+e.replace(_,function(e){var t=J[e];return t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).substr(-4)})+'"':'"'+e+'"'},Object:function(e){var t,n="{";for(t in e){if(E.call(e,t)){n+=(n.length>1?",":b)+G.toString(t)+":"+G.toString(e[t])}}return n+"}"},Array:function(e){var t,n="[";for(t=0;t<e.length;t++){n+=(n.length>1?",":b)+G.toString(e[t])}return n+"]"},Date:X,Function:function(e){return e.toString().replace(N,"$1")},RegExp:function(e){return"/"+e.source+"/"+(e.global?"g":b)+(e.ignoreCase?"i":b)}}),Q=V({Number:function(e){return isFinite(e)?e:null},String:W,Boolean:W,Date:X,Object:function(e){var n,r,i={};for(n in e){if(E.call(e,n)){r=G.jsonData(e[n]);if(t!==r){i[n]=r}}}return i},Array:function(e){var n,r,i=[];for(n=0;n<e.length;n++){r=G.jsonData(e[n]);if(t!==r){i.push(r)}}return i}}),G=function(e,n){var r,i;if(this instanceof G){G.error(a,G)}if(e&&!G.isString(e)){n=e;e=n[f]}r=function(){var e=arguments.callee.caller;if(e===G){return this}if(this instanceof r){r.getInstance&&e!==r.getInstance&&G.error(a,r);this[c]=G.id();this.initialize&&this.initialize.apply(this,arguments);return this}return r.body?r.body.apply(r,arguments):t};if(n){if(n.superClass){i=G.loadClass(n.superClass)||G.error(u.replace("%s",n.superClass),"JSC");delete n.superClass;r.prototype=new i;r.prototype.constructor=r}G.extend(r,n,i);if(i){r.superClass=i[f]||G.type(i);n.superClass=i}}r.interfaces=i&&i.interfaces?G.merge({},i.interfaces):{};return G.basis(r,e)};if(!b.trim){String.prototype.trim=function(){return this.replace(D,b)}}G.version="0.5.1";G[f]="JSC";G[c]=0;G.noop=function(){};G.id=function(e,n){if(t!==e&&null!==e){return e[c]||(G===e?0:e[c]=n||++r)}return n||++r};G.type=function(e){if(null==e){return String(e)}if(e[f]){return e[f]}var t=S.call(e);return $[t]||($[t]=(t.match(x)||[0,"Object"])[1])};G.isFunction=function(e){return e&&R===S.call(e)?true:false};G.isClass=function(e){return e&&e[f]&&R===S.call(e)?true:false};G.isInstance=function(e){return e&&e[f]&&R!==S.call(e)?true:false};G.isAbstract=function(e){return e&&e[h]?true:false};G.isAttached=function(e){return e&&e[p]?true:false};G.isOverloaded=function(e){return e&&e[d]?true:false};G.isPlugin=function(e){return e&&e[v]?true:false};G.isArray=Array.isArray||function(e){return e&&I===S.call(e)?true:false};G.isObject=function(e){return e&&q===S.call(e)?true:false};G.isEmptyObject=function(e){if(!G.isObject(e)){return false}for(var t in e){return false}return true};G.isString=function(e){return b===e||e&&U===S.call(e)?true:false};G.isBool=function(e){return false===e||e&&z===S.call(e)?true:false};G.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)};G.isNull=function(e){return e===null};G.isUndef=function(e){return e===t};G.isVoid=function(e){return e===t||e===null};G.isHTML=function(e){if(G.isString(e)){var t;e=e.trim();if("<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3){t=[null,e,null]}else{t=C.exec(e)}return t&&t[1]?true:false}return false};G.isSelector=function(e){if(G.isString(e)){var t=k.exec(e.trim());return t&&t[0]?true:false}return false};G.isURL=function(e){if(G.isString(e)){var t=L.exec(e.trim());return t&&t[0]?true:false}return false};G.camelize=function(e,n){e=(b+(t===e?b:e)).replace(A,function(e,t,n){return t+n.toUpperCase()});return n?e.charAt(0).toUpperCase()+e.substr(1):e};G.underscore=function(e,n){e=(b+(t===e?b:e)).replace(O,"$1_$2");return n?e.toLowerCase():e};G.regex=function(e){return(b+(t===e?b:e)).replace(M,"\\$1")};G.error=function(e,t){throw new G.Error(e,t)};G.globalize=function(e,r){if(e&&!G.isString(e)&&t===r){r=e;e=e[f]}if(t!==r){n[e]=r}else{r=n[e];delete n[e]}return r};G.global=function(e){return n[e]};G.toString=function(){if(arguments.length){var e,t=arguments[0];if(!t&&b!==t){return String(t)}else{e=S.call(t);return K[e]?K[e](t):t.toString()}}return G[f]+" "+G.version};G.jsonData=function(e){if(e){var n=S.call(e);return Q[n]?Q[n](e):t}return e};G.jsonEncode=function(e){e=G.jsonData(e);return t!==e?G.toString(e):b};G.jsonDecode=function(e){if(G.isString(e)){try{e=e.trim();if(e){if(n.JSON&&n.JSON.parse){return n.JSON.parse(e)}if(P.test(e.replace(H,"@").replace(B,"]").replace(j,b))){return(new Function("return "+e+";"))()}}}catch(t){}}return null};G.sort=function(e,t,n){var r,i,s,o,u,a,f;if(G.isArray(e)){t=!t?[]:G.isArray(t)?t:[t];if(t.length){e.sort(function(e,n){a=G.isVoid(e);f=G.isVoid(n);if(!a&&!f){u=false;for(r=0;r<t.length;r++){i=t[r];s=e[i];o=n[i];a=G.isVoid(s);f=G.isVoid(o);if(!a&&!f){if(s<o){return-1}if(s>o){return 1}continue}else if(a&&f){u=true}else{return a?-1:1}}return u?e<n?-1:e>n?1:0:0}else{return a?-1:f?1:0}})}else{e.sort()}if(n){r=0;i=e.length-1;if(r<=i){a=f=true;while(r<=i){if(a){if(G.isVoid(e[r])){r++}else{a=false}}if(f){if(G.isVoid(e[i])){i--}else{f=false}}if(!a&&!f){break}}}r&&e.splice(0,r);i<e.length-1&&e.splice(i,e.length-i)}}return e};G.shuffle=function(e){if(G.isArray(e)){var t=e.length,n,r;while(t){n=parseInt(Math.random()*--t);r=e[t];e[t]=e[n];e[n]=r}}return e};G.merge=function(e){var n,r,i,s,o,u=false;for(r=0;r<arguments.length;r++){e=arguments[r];if(G.isBool(e)){u=e}else if(!n){n=e}else{for(i in e){s=n[i];o=e[i];if(u&&o){if(G.isObject(o)){n[i]=G.merge(u,G.isObject(s)?s:{},o);continue}else if(G.isArray(o)){n[i]=G.merge(u,G.isArray(s)?s:[],o);continue}}if(t!==o){n[i]=o}}}}return n||{}};G.each=function(e,t){var n,r,i,s;if(e&&t){if(G.isArray(e)){if(G.isFunction(t)){for(n=0;n<e.length;n++){s=e[n];t.call(s,n,s,e)}}else{r=w.call(arguments,2);for(n=0;n<e.length;n++){s=e[n];i=s[t];G.isFunction(i)&&i.apply(s,r)}}}else{if(G.isFunction(t)){for(n in e){s=e[n];t.call(s,n,s,e)}}else{r=w.call(arguments,2);for(n in e){s=e[n];i=s[t];G.isFunction(i)&&i.apply(s,r)}}}}return e};G.owned=function(e){var t,n={};if(e){for(t in e){if(E.call(e,t)){n[t]=e[t]}}}return n};G.attach=function(e,n){var r,i;if(e&&G.isString(n)){r=e[n];n=e;e=r}e=G.isFunction(e)?e:G.noop;i=w.call(arguments,2);r=function(){return e.apply(n,i.concat(w.call(arguments)))};r[p]=true;G.id(r,e?G.id(e):t);return r};G.abstractMethod=function(e){var t=function(){var t=(this[f]||"[unknownClass]")+"."+(e||"[unknownMethod]");G.error(o.replace("%s",t),t)};t[h]=true;return t};G.overload=function(e,t){if(e!==t&&G.isFunction(e)&&T.test(e)){t=G.isFunction(t)?t:G.noop;var n=function(){var n,r=this.inherited;this.inherited=t;n=e.apply(this,arguments);this.inherited=r;return n};n[d]=true;G.id(n,G.id(e));return n}return e};G.extend=function(e,t,n){if(e&&e.prototype){for(var r in t){if(E.call(t,r)){e.prototype[r]=n?G.overload(t[r],n.prototype[r]):t[r]}}}return e};G.implement=function(e,n,r){var i,s;if(e&&e.prototype){if(G.isString(n)){i=r;r=n;n=i}if(n){if(G.isArray(n)){for(i=0;i<n.length;i++){s=n[i];if(t===e.prototype[s]&&f!==s){e.prototype[s]=G.abstractMethod(s)}}}else{r=r||n[f];for(i in n){s=n[i];if(t===e.prototype[i]&&f!==i){e.prototype[i]=t===s?G.abstractMethod(i):s}}}}if(r){e.interfaces=e.interfaces||{};e.interfaces[r]=true}}return e};G.method=function(e,t,n){e=G.loadClass(e)||G.error(u.replace("%s",e),"JSC");return(e.prototype[t]||G.noop).apply(n||e,w.call(arguments,3))};G.instanceOf=function(e,t){if(e&&t){var n=e.constructor&&e.constructor.interfaces?e.constructor.interfaces:e.interfaces||y,r=e[f],i;if(G.isString(t)){if(n[t]||t===r){return true}t=G.getClass(t);if(!t){return false}}i=t[f];if(G.isFunction(t)){return e instanceof t||n[i]||r===i?true:false}return n[i]||r===i?true:false}return false};G.getClass=function(e){var n=G.isString(e)?G.global(e):e;return G.isFunction(n)?n:t};G.loadClass=function(e){return G.getClass(e)||G.error(u.replace("%s",e),"JSC.loadClass")};G.singleton=function(e,n){var r,i=G(e,n);i.getInstance=function(){if(t===r){r=new i}return r};return i.self()};G.multiton=function(e,n){var r={},i=G(e,n);i.getInstance=function(e){var n=b+e;if(t===r[n]){r[n]=new i(e)}return r[n]};return i.self()};G.make=function(e,t,n,r){var i,s,o,u,a,l,c;for(s=0;s<arguments.length;s++){o=arguments[s];switch(typeof o){case"undefined":break;case"string":u=o.toLowerCase();break;case"boolean":c=o;break;default:if(a){l=o}else{a=o}}}i="singleton"===u?G.singleton(a):"multiton"===u?G.multiton(a):G(a);l&&i.statics(l);return false!==c&&i[f]?G.globalize(i):i};G.basis=function(e,t){e.extend=function(e){return G.extend(this,e,this)};e.implement=function(e,t){return G.implement(this,e,t)};e.statics=function(e){return G.merge(this,e)};e.method=function(e,t){return(this.prototype[e]||G.noop).apply(t||this,w.call(arguments,2))};e.self=function(e){this.body=G.isString(e)?this[e]:e||this.getInstance;return this};e.rename=function(e){this.prototype[f]=this[f]=e||i;return this};e.prototype.attach=function(e,t){if(e&&this[e]){var n="__cache__"+e;if(t||!this[n]){this[n]=G.attach.apply(G,[this,e].concat(w.call(arguments,2)))}return this[n]}else{return G.noop}};G.id(e.rename(t));return e};G.isInstalled=function(e){var t;if(e){if(isNaN(e)){if(G.isString(e)){t=e}else if(G.isObject(e)&&!G.isEmptyObject(e)){t=e[l]||G.id(e)}}else{t=e}}return!t||m[t]?true:false};G.install=function(e){var t,n,r,i,s,o=0;if(G.isObject(e)&&e[l]){t=e[l];o=G.id(e);if(o&&!m[t]){m[o]=m[t]=s={};s[l]=t;s[c]=o;for(n in e){if(l===n||c===n){continue}r=e[n];if(G.isObject(r)||G.isFunction(r)){s[n]=i=G[n];if(i){if(G.isFunction(i)){if(G.isFunction(r)){G[n]=G.overload(r,i)}else{G[n]=G.merge(i,r)}}else if(G.isObject(i)){G[n]=G.merge(r,i)}else{G[n]=r}}else{G[n]=r}G[n][v]=o}}}}return o};G.uninstall=function(e){var n,r;if(e){if(isNaN(e)){if(G.isString(e)){n=e}else if(G.isObject(e)&&!G.isEmptyObject(e)){n=e[l]||G.id(e)}}else{n=e}e=m[n];if(e){for(r in e){if(t!==e[r]){G[r]=e[r]}else{delete G[r]}}delete m[e[l]];delete m[e[c]]}else{n=0}}return n?true:false};G.Error=G({className:"JSC.Error",superClass:Error,initialize:function(e,t){this.message=e||s;this.context=t}});G.globalize(G);var Y=localStorage||{},Z=Y.getItem||function(e){return this[e]},et=Y.setItem||function(e,t){this[e]=t},tt=Y.removeItem||function(e){t!==this[e]&&delete this[e]},nt={className:"LocalStorage",initialize:function(e){this.name=e||this.name;this.load();localStorage&&this.bindEvent(globalContext,"unload",G.attach(this,"store"))},load:function(){this.data=G.jsonDecode(Z.call(Y,this.name))||{}},store:function(){if(G.isEmptyObject(this.data)){tt.call(Y,this.name)}else{et.call(Y,this.name,G.jsonEncode(this.data))}},set:function(e,t){this.data[e]=t;return this},get:function(e){return this.data[e]},remove:function(e){var n=this.data[e];t!==n&&delete this.data[e];return n},clear:function(){this.data={};return this},bindEvent:function(e,t,n){if(e.addEventListener){e.addEventListener(t,n,false)}else if(e.attachEvent){e.attachEvent("on"+t,n)}},name:G.className,data:null};G.localStorage=G.multiton(nt);var rt='<div class="error">An error has occurred !</div>',it=e(),st={className:"Template",initialize:function(e){this.renderTo=[];this.modifiers={};this.postProcessors={};e&&this.load(e)},load:function(t){this.template="";this.loaded=false;if(G.isString(t)){if(G.isHTML(t)){this.template=t;this.loaded=true}else if(G.isSelector(t)){this.template=e(t).html();this.loaded=true}else if(G.isURL(t)){e.ajax({url:t,cache:false,dataType:"text",error:this.attach("_ajaxTemplateError"),success:this.attach("_ajaxTemplateSuccess")});return this}else{this.template=this.errorTemplate;this.loaded=true}}else if(t&&t.jquery){this.template=t.html();this.loaded=true}else{this.template=this.errorTemplate;this.loaded=true}if(this.loaded){if(this._onLoad){this.template=this._onLoad.call(this,this.template,t,this)||this.template}this.compile();if(this._onLoaded){this.nodes=this._onLoaded.call(this,this.nodes,this.template,this)||this.nodes}}return this},render:function(t,n,r){t=t||{};if(n){n=n.jquery?n:e(n);r=r?true:false;if(G.isString(t)){if(G.isURL(t)){e.ajax({url:t,cache:false,dataType:"json",error:G.attach(this,"_ajaxDataError",n,r),success:G.attach(this,"_ajaxDataSuccess",n,r)});return this}else{t=G.jsonDecode(t)||[]}}this.renderTo.push({place:n,data:t,clean:r});return this.inject()}return this.compose(t)},inject:function(){if(this.loaded){while(this.renderTo.length){var e,t=this.renderTo.splice(0,1)[0];t.clean&&t.place.empty();e=this.compose(t.data);if(this._onRender){e=this._onRender.call(this,e,t.data,this)||e}t.place.append(e);this._onAppend&&this._onAppend.call(this,t.place,e,t.data,this)}}return this},_ajaxTemplateError:function(e,t,n){var r=this.errorTemplate;if(this._onError){r=this._onError.call(this,r,t,e,n,this)||r}this.load(r).loaded&&this.inject()},_ajaxTemplateSuccess:function(e,t,n){if(this._onSuccess){e=this._onSuccess.call(this,e,t,n,this)||e}this.load(e).loaded&&this.inject()},_ajaxDataError:function(t,n,r,i,s){var o=this.errorTemplate;if(this._onDataError){o=this._onDataError.call(this,t,n,i,r,s,this)||o}if(t){n&&t.empty();t.append(e(o))}},_ajaxDataSuccess:function(e,t,n,r,i){if(this._onDataSuccess){n=this._onDataSuccess.call(this,n,e,t,r,i,this)||n}this.render(n,e,t)},compile:function(){this.nodes=this.template?e(this.template):it;return this},cloneTemplate:function(){if(this.nodes&&this.nodes.length){return this.nodes.clone()}return it},compose:function(t,n,r){var i,s,o,u,a,f=this;t=t||[];r=r||!n;n=n||this.cloneTemplate();if(G.isArray(t)){s=n.find('[data-context="template"]');if(s.length){s.each(function(){var n=e(this);n.append(f.compose(t,n.children().remove(),r))})}else if(n.length){u=it;for(i=0;i<t.length;i++){o=this.compose(t[i],i+1<t.length?n.clone():n);r&&this.globalPostProcess(o,t[i]);u=u.add(o)}n=u}}else{for(i in t){a=this.modifiedData(i,t);o=n.find('[data-name="'+i+'"]');if(G.isArray(a)){o.each(function(){var t=e(this);t.append(f.compose(a,t.children().remove()))})}else{o.html(a)}this.postProcess(i,o,t)}r&&this.globalPostProcess(n,t)}return n},modifiedData:function(e,t){if(G.isFunction(this.modifiers[e])){return this.modifiers[e].call(this,t[e],e,t,this)}return t[e]},postProcess:function(e,t,n){if(G.isFunction(this.postProcessors[e])){this.postProcessors[e].call(this,t,n,e,this)}return t},globalPostProcess:function(e,t){if(G.isFunction(this.globalPostProcessor)){this.globalPostProcessor.call(this,e,t,this)}return e},setModifiers:function(e){if(G.isObject(e)){this.modifiers=e}return this},getModifiers:function(){return this.modifiers},setModifier:function(e,t){if(G.isFunction(t)){this.modifiers[e]=t}return this},getModifier:function(e){return this.modifiers[e]},setPostProcessors:function(e){if(G.isObject(e)){this.postProcessors=e}return this},getPostProcessors:function(){return this.postProcessors},setPostProcessor:function(e,t){if(G.isFunction(t)){this.postProcessors[e]=t}return this},getPostProcessor:function(e){return this.postProcessors[e]},setGlobalPostProcessor:function(e){if(G.isFunction(e)){this.globalPostProcessor=e}return this},getGlobalPostProcessor:function(e){return this.globalPostProcessor},on:function(e,t){e="_on"+e.charAt(0).toUpperCase()+e.substr(1);if(t){if(G.isFunction(t)){this[e]=t}return this}return this[e]},onRender:function(e){return this.on("render",e)},onAppend:function(e){return this.on("append",e)},onLoad:function(e){return this.on("load",e)},onLoaded:function(e){return this.on("loaded",e)},onSuccess:function(e){return this.on("success",e)},onError:function(e){return this.on("error",e)},onDataSuccess:function(e){return this.on("dataSuccess",e)},onDataError:function(e){return this.on("dataError",e)},loaded:false,renderTo:[],template:"",errorTemplate:rt,nodes:it,modifiers:null,postProcessors:null,globalPostProcessor:null};G.Template=G(st).self(function(e){return new this(e)});var w=[].slice,ot={className:"Schema",initialize:function(e,t){this.name=e;this.nested=t;this.nodes={}},rename:function(e){this.name=e},nest:function(e){this.nested=e},node:function(e,t){var n=G.isObject(e)&&e instanceof G.Schema?e:this.find(e);return n||(t?this.node(t):this).add(e)},move:function(e,t){var n=this.remove(e);n&&(t?this.node(t):this).add(n);return n},add:function(e){var t;if(G.isObject(e)&&e instanceof G.Schema){t=e;e=t.name}else{t=this.nodes[e]||G.Schema(e)}this.nodes[e]=t;return t},remove:function(e){var t,n;if(e){if(this.nodes[e]){n=this.nodes[e];delete this.nodes[e];return n}for(t in this.nodes){n=this.nodes[t].remove(e);if(n){return n}}}return null},find:function(e){var t,n;if(e){if(this.nodes[e]){return this.nodes[e]}for(t in this.nodes){n=this.nodes[t].find(e);if(n){return n}}}return null},walk:function(e){var t,n,r=w.call(arguments,0);r[0]=this;e.apply(this,r);for(t in this.nodes){n=this.nodes[t];n.walk.apply(n,arguments)}return this},walkBack:function(e){var t,n,r=w.call(arguments,0);for(t in this.nodes){n=this.nodes[t];n.walkBack.apply(n,arguments)}r[0]=this;e.apply(this,r);return this},name:null,nested:null,nodes:null};G.Schema=G(ot).self(function(e,t){return new this(e,t)})})(jQuery)
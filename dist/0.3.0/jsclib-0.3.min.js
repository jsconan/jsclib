/*!
 * JavaScript Class Library v0.3.0 (JSC v0.3.0)
 *
 * Copyright 2012 Jean-Sebastien CONAN
 * Released under the MIT license
 */
(function(e){var t=this,n=0,r="Unexpected error !",i="%s : This method is abstract and have to be overridden !",s="Class [%s] not found !",o="This class cannot be directly instantiated !",u=[],a={},f=u.slice,l=a.hasOwnProperty,c=a.toString,h=function(e){var t,n={};for(t=0;t<e.length;t++){n["[object "+e[t]+"]"]=e[t]}return n}(["Array","Boolean","Date","Function","Object","Number","RegExp","String"]),p=/^\[object\s(.*)\]$/,d=/inherited/.test(function(){this.inherited()})?/\binherited\b/:/.*/,v=/\s*([\(\)\[\]\{\};]+)\s*/g,m=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,y=/^[\],:{}\s]*$/,b=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,w=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,E=/(?:^|:|,)(?:\s*\[)+/g,S={'"':'\\"',"\\":"\\\\","	":"\\t","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r"},x={"[object String]":function(e){return m.test(e)?'"'+e.replace(m,function(e){var t=S[e];return t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).substr(-4)})+'"':'"'+e+'"'},"[object Object]":function(e){var t,n="{";for(t in e){if(l.call(e,t)){n+=(n.length>1?",":"")+k.toString(t)+":"+k.toString(e[t])}}return n+"}"},"[object Array]":function(e){var t,n="[";for(t=0;t<e.length;t++){n+=(n.length>1?",":"")+k.toString(e[t])}return n+"]"},"[object Function]":function(e){return e.toString().replace(v,"$1")},"[object RegExp]":function(e){return"/"+e.source+"/"+(e.global?"g":"")+(e.ignoreCase?"i":"")}},T=function(e){return e},N={"[object Number]":function(e){return isFinite(e)?e:null},"[object String]":T,"[object Boolean]":T,"[object Object]":function(t){var n,r,i={};for(n in t){if(l.call(t,n)){r=k.jsonData(t[n]);if(e!==r){i[n]=r}}}return i},"[object Array]":function(t){var n,r,i=[];for(n=0;n<t.length;n++){r=k.jsonData(t[n]);if(e!==r){i.push(r)}}return i}};if(!"".trim){String.prototype.trim=function(){return this.replace(g,"")}}var C=function(e,t){this.message=e;this.context=t};C.prototype=new Error;C.prototype.constructor=C;C.prototype.className=C.className="JSCError";var k={version:"0.3.0",className:"JSC",guid:0,noop:function(){},id:function(e,t){if("undefined"!==typeof e){return e.guid||(k===e?e.guid:e.guid=t||++n)}return t||++n},type:function(e){if(null==e){return String(e)}if(e.className){return e.className}var t=c.call(e);return h[t]||(h[t]=(t.match(p)||[0,"Object"])[1])},isFunction:function(e){return e&&"[object Function]"===c.call(e)?true:false},isClass:function(e){return e&&e.className&&"[object Function]"===c.call(e)?true:false},isInstance:function(e){return e&&e.className&&"[object Function]"!==c.call(e)?true:false},isAbstract:function(e){return e&&k.isFunction(e)&&e.abstractMethod?true:false},isAttached:function(e){return e&&k.isFunction(e)&&e.attached?true:false},isInherited:function(e){return e&&k.isFunction(e)&&e.inheritance?true:false},isArray:Array.isArray||function(e){return e&&"[object Array]"===c.call(e)?true:false},isObject:function(e){return e&&"[object Object]"===c.call(e)?true:false},isEmptyObject:function(e){if(!k.isObject(e)){return false}for(var t in e){return false}return true},isString:function(e){return""===e||e&&"[object String]"===c.call(e)?true:false},isBool:function(e){return false===e||e&&"[object Boolean]"===c.call(e)?true:false},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},isNull:function(e){return e===null},isUndef:function(t){return t===e},isVoid:function(t){return t===e||t===null},error:function(e,t){throw new C(e||r,t)},globalize:function(e,n){if(e&&!k.isString(e)&&"undefined"===typeof n){n=e;e=e.className}t[""+e]=n;return n},global:function(e){return t[e]},toString:function(){if(arguments.length){var e,t=arguments[0];if(!t&&""!==t){return String(t)}else{e=c.call(t);return x[e]?x[e](t):t.toString()}}return k.className+" "+k.version},jsonData:function(t){if(t){var n=c.call(t);return N[n]?N[n](t):e}return t},jsonEncode:function(t){t=k.jsonData(t);return e!==t?k.toString(t):""},jsonDecode:function(e){if(e&&"string"===typeof e){try{e=e.trim();if(e){if(t.JSON&&t.JSON.parse){return t.JSON.parse(e)}if(y.test(e.replace(b,"@").replace(w,"]").replace(E,""))){return(new Function("return "+e+";"))()}}}catch(n){}}return null},sort:function(e,t,n){var r,i,s,o,u,a,f;if(k.isArray(e)){t=!t?[]:k.isArray(t)?t:[t];if(t.length){e.sort(function(e,n){a=k.isVoid(e);f=k.isVoid(n);if(!a&&!f){u=false;for(r=0;r<t.length;r++){i=t[r];s=e[i];o=n[i];a=k.isVoid(s);f=k.isVoid(o);if(!a&&!f){if(s<o){return-1}if(s>o){return 1}continue}else if(a&&f){u=true}else{return a?-1:1}}return u?e<n?-1:e>n?1:0:0}else{return a?-1:f?1:0}})}else{e.sort()}if(n){r=0;i=e.length-1;if(r<=i){a=f=true;while(r<=i){if(a){if(k.isVoid(e[r])){r++}else{a=false}}if(f){if(k.isVoid(e[i])){i--}else{f=false}}if(!a&&!f){break}}}r&&e.splice(0,r);i<e.length-1&&e.splice(i,e.length-i)}}return e},shuffle:function(e){if(k.isArray(e)){var t=e.length,n,r;while(t){n=parseInt(Math.random()*--t);r=e[t];e[t]=e[n];e[n]=r}}return e},merge:function(t){var n,r,i,s,o,u=false;for(r=0;r<arguments.length;r++){t=arguments[r];if(k.isBool(t)){u=t}else if(!n){n=t}else{for(i in t){s=n[i];o=t[i];if(u&&o){if(k.isObject(o)){n[i]=k.merge(u,k.isObject(s)?s:{},o);continue}else if(k.isArray(o)){n[i]=k.merge(u,k.isArray(s)?s:[],o);continue}}if(o!==e){n[i]=o}}}}return n||{}},each:function(e,t){var n,r,i,s;if(e&&t){if(k.isArray(e)){if(k.isFunction(t)){for(n=0;n<e.length;n++){s=e[n];t.call(s,n,s,e)}}else{r=f.call(arguments,2);for(n=0;n<e.length;n++){s=e[n];i=s[t];k.isFunction(i)&&i.apply(s,r)}}}else{if(k.isFunction(t)){for(n in e){s=e[n];t.call(s,n,s,e)}}else{r=f.call(arguments,2);for(n in e){s=e[n];i=s[t];k.isFunction(i)&&i.apply(s,r)}}}}return e},owned:function(e){var t,n={};if(e){for(t in e){if(l.call(e,t)){n[t]=e[t]}}}return n},attach:function(t,n){if(t&&k.isString(n)){var r=t[n];n=t;t=r}var i=k.noop;if(k.isFunction(t)){var s=f.call(arguments,2);i=function(){return t.apply(n,s.concat(f.call(arguments)))};i.attached=true}k.id(i,t?k.id(t):e);return i},abstractMethod:function(e){var t=function(){var t=(this.className||"[unknownClass]")+"."+(e||"[unknownMethod]");k.error(i.replace("%s",t),t)};t.abstractMethod=true;return t},override:function(e,t){if(e!==t&&k.isFunction(e)&&d.test(e)){t=k.isFunction(t)?t:k.noop;var n=function(){var n=this.inherited;this.inherited=t;var r=e.apply(this,arguments);this.inherited=n;return r};n.inheritance=true;return n}return e},extend:function(e,t,n){if(e&&e.prototype){for(var r in t){if(l.call(t,r)){e.prototype[r]=n?k.override(t[r],n.prototype[r]):t[r]}}}return e},implement:function(t,n,r){var i,s;if(t&&t.prototype){if(k.isString(n)){var o=r;r=n;n=o}if(n){if(k.isArray(n)){for(i=0;i<n.length;i++){s=n[i];if(e===t.prototype[s]&&"className"!==s){t.prototype[s]=k.abstractMethod(s)}}}else{r=r||n.className;for(i in n){s=n[i];if(e===t.prototype[i]&&"className"!==i){t.prototype[i]=e===s?k.abstractMethod(i):s}}}}if(r){t.interfaces=t.interfaces||{};t.interfaces[r]=true}}return t},instanceOf:function(e,t){var n,r;if(e&&t){r=e.constructor&&e.constructor.interfaces?e.constructor.interfaces:e.interfaces||a;if(k.isString(t)){if(r[t]||t===e.className){return true}n=k.getClass(t);if(n){t=n}else{return false}}if(k.isFunction(t)){return e instanceof t||r[t.className]||e.className===t.className?true:false}return r[t.className]||e.className===t.className?true:false}return false},getClass:function(t){var n=k.isString(t)?k.global(t):t;return k.isFunction(n)?n:e},loadClass:function(e){return k.getClass(e)||k.error(s.replace("%s",e),"JSC.loadClass")},Class:function(t,n){var r,i;if(t&&!k.isString(t)){n=t;t=n.className}r=function(){if(arguments.callee.caller===k.Class){return this}if(this instanceof r){r.getInstance&&arguments.callee.caller!==r.getInstance&&k.error(o,t);this.guid=k.id();this.initialize&&this.initialize.apply(this,arguments);return this}return r.body?r.body.apply(r,arguments):e};if(n){if(n.superClass){i=k.loadClass(n.superClass)||k.error(s.replace("%s",n.superClass),"JSC.Class");n.superClass=i.className||k.type(i);r.prototype=new i;r.prototype.constructor=r}k.extend(r,n,i)}r.extend=function(e){return k.extend(this,e,i)};r.implement=function(e,t){return k.implement(this,e,t)};r.statics=function(e){return k.merge(this,e)};r.interfaces=i&&i.interfaces?k.merge({},i.interfaces):{};r.prototype.attach=function(e,t){if(e&&this[e]){var n="__cache__"+e;if(t||!this[n]){this[n]=k.attach.apply(k,[this,e].concat(f.call(arguments,2)))}return this[n]}else{return k.noop}};r.prototype.className=r.className=t;r.guid=k.id();return r},Singleton:function(t,n){var r=k.Class(t,n);r.getInstance=function(){if(e===this.__instance){this.__instance=new r}return this.__instance};return r},Multiton:function(t,n){var r=k.Class(t,n);r.getInstance=function(t){var n=""+t;this.__instances=this.__instances||{};if(e===this.__instances[n]){this.__instances[n]=new r(t)}return this.__instances[n]};return r},Make:function(e,t,n,r){var i,s,o,u,a,f,l;for(s=0;s<arguments.length;s++){o=arguments[s];switch(typeof o){case"undefined":break;case"string":u=o.toLowerCase();break;case"boolean":l=o;break;default:if(a){f=o}else{a=o}}}i="singleton"===u?k.Singleton(a):"multiton"===u?k.Multiton(a):k.Class(a);f&&i.statics(f);return false!==l&&i.className?k.globalize(i):i}};k.globalize(k);k.globalize(C)})()